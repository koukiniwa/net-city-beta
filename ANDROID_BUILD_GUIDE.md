# NET CITY β - Androidアプリビルドガイド（Windows版）

WindowsでAndroidアプリをビルドして、Google Playストアに公開するまでの完全ガイドです。

---

## 📋 必要なもの

- ✅ Windows 10/11
- ✅ 約10GBの空き容量
- ✅ インターネット接続
- ✅ Google アカウント（Google Play公開用）
- ✅ クレジットカード（Google Play登録料: $25の1回のみ）

---

## ステップ1: Android Studio のインストール

### 1-1. ダウンロード
1. [Android Studio公式サイト](https://developer.android.com/studio) にアクセス
2. 「Download Android Studio」をクリック
3. 利用規約に同意してダウンロード
4. `android-studio-xxxx.exe` がダウンロードされる

### 1-2. インストール
1. ダウンロードしたインストーラーを実行
2. 「Next」をクリック
3. すべてのコンポーネントにチェック（デフォルトでOK）
4. インストール先を選択（デフォルトでOK）
5. 「Install」をクリック
6. インストール完了まで待つ（10〜15分）

### 1-3. 初回セットアップ
1. Android Studioを起動
2. 「Do not import settings」を選択
3. セットアップウィザードが起動
4. 「Next」をクリック
5. 「Standard」を選択（推奨設定）
6. テーマを選択（お好みで）
7. 設定を確認して「Next」
8. ライセンス契約に同意
9. 「Finish」をクリック
10. 必要なSDKがダウンロードされる（10〜20分）

---

## ステップ2: プロジェクトの準備

### 2-1. Node.js が必要
Node.jsがインストールされていない場合:
1. [Node.js公式サイト](https://nodejs.org/) から LTS版をダウンロード
2. インストール
3. コマンドプロンプトで確認:
```bash
node --version
npm --version
```

### 2-2. プロジェクトフォルダに移動
```bash
cd "C:\Users\kouki\OneDrive\デスクトップ\new city"
```

### 2-3. 依存関係をインストール
```bash
npm install
```

### 2-4. アイコンとスプラッシュスクリーンを生成
```bash
npm run assets
```

エラーが出る場合:
```bash
npx capacitor-assets generate --iconBackgroundColor '#0a0e27' --splashBackgroundColor '#0a0e27'
```

### 2-5. Androidプロジェクトに同期
```bash
npm run sync:android
```

---

## ステップ3: Android Studio でプロジェクトを開く

### 3-1. プロジェクトを開く
```bash
# コマンドで開く
npm run open:android
```

または、手動で:
1. Android Studioを起動
2. 「Open」をクリック
3. `C:\Users\kouki\OneDrive\デスクトップ\new city\android` を選択
4. 「OK」をクリック

### 3-2. Gradleの同期
- プロジェクトが開くと自動的にGradleの同期が始まる
- 初回は5〜10分かかる
- 下部のステータスバーで進行状況を確認

エラーが出る場合:
- メニュー: `File` → `Sync Project with Gradle Files`

---

## ステップ4: デバッグ版APKをビルド

### 4-1. ビルドを実行
1. メニュー: `Build` → `Build Bundle(s) / APK(s)` → `Build APK(s)`
2. ビルド開始（初回は5〜10分）
3. 下部のBuildタブで進行状況を確認
4. 成功すると通知が表示される: 「APK(s) generated successfully」

### 4-2. APKファイルの場所
```
C:\Users\kouki\OneDrive\デスクトップ\new city\android\app\build\outputs\apk\debug\app-debug.apk
```

通知の「locate」をクリックすると、フォルダが開く

### 4-3. APKをスマホにインストール

**方法A: USBケーブルで接続**
1. スマホの設定を開く
2. 「デバイス情報」→「ビルド番号」を7回タップ
3. 「開発者向けオプション」が有効になる
4. 「開発者向けオプション」→「USBデバッグ」をONにする
5. USBケーブルでPCとスマホを接続
6. スマホで「このPCを信頼」を許可
7. Android Studioの▶ボタンをクリック
8. スマホを選択して「OK」

**方法B: APKファイルを転送**
1. `app-debug.apk` をスマホに転送
   - メールで送る
   - Googleドライブにアップロード
   - USBケーブルで直接コピー
2. スマホでAPKファイルを開く
3. 「提供元不明のアプリ」のインストールを許可
4. 「インストール」をタップ

---

## ステップ5: リリース版APK/AABをビルド

Google Playストアに公開するには、署名付きのリリース版が必要です。

### 5-1. 署名鍵の作成

1. メニュー: `Build` → `Generate Signed Bundle / APK`
2. 「Android App Bundle」を選択（推奨）
3. 「Next」をクリック
4. 「Create new...」をクリック（鍵ストアを作成）

### 5-2. 鍵ストア情報を入力

```
Key store path: C:\Users\kouki\netcity-keystore.jks
Password: （安全なパスワード、忘れないように！）
Confirm: （同じパスワード）

Key:
Alias: netcity-key
Password: （鍵のパスワード、ストアと同じでもOK）
Confirm: （同じパスワード）
Validity (years): 25

Certificate:
First and Last Name: koukiniwa
Organizational Unit: （空欄でOK）
Organization: （空欄でOK）
City or Locality: （空欄でOK）
State or Province: （空欄でOK）
Country Code (XX): JP
```

5. 「OK」をクリック

### 5-3. リリースビルドを作成

1. 鍵ストア情報が自動入力される
2. 「Next」をクリック
3. Build Variants: `release`
4. Signature Versions: V1とV2両方にチェック
5. 「Finish」をクリック
6. ビルド完了まで待つ（5〜10分）

### 5-4. AABファイルの場所
```
C:\Users\kouki\OneDrive\デスクトップ\new city\android\app\build\outputs\bundle\release\app-release.aab
```

**重要**: `netcity-keystore.jks` は絶対に無くさないでください！
- 安全な場所にバックアップ
- パスワードも記録
- これがないとアプリを更新できなくなります

---

## ステップ6: Google Play Console の準備

### 6-1. Google Play Console に登録

1. [Google Play Console](https://play.google.com/console/) にアクセス
2. Googleアカウントでログイン
3. 「アカウントを作成」
4. デベロッパーアカウント情報を入力:
   - デベロッパー名: koukiniwa
   - メールアドレス
   - ウェブサイト（任意）: https://koukiniwa.github.io/net-city-beta/
5. 利用規約に同意
6. **登録料 $25 USD** を支払い（クレジットカード）
7. 本人確認（必要な場合）

### 6-2. 新しいアプリを作成

1. 「すべてのアプリ」→「アプリを作成」
2. アプリの詳細:
   - **アプリ名**: NET CITY β
   - **デフォルトの言語**: 日本語（日本）
   - **アプリまたはゲーム**: アプリ
   - **無料または有料**: 無料
3. 宣言にチェック
4. 「アプリを作成」をクリック

---

## ステップ7: アプリ情報の入力

### 7-1. ダッシュボード画面

左側のメニューから各項目を入力していきます。

### 7-2. アプリのアクセス

- **アプリのコンテンツ**: すべてのユーザーがアクセス可能
- **特別なアクセス要件**: なし

### 7-3. 広告

- **アプリに広告が含まれていますか？**: いいえ

### 7-4. コンテンツのレーティング

1. 「アンケートを開始」
2. メールアドレスを入力
3. カテゴリ: **コミュニケーション**
4. 質問に回答:
   - 暴力: なし
   - セクシャル: なし
   - 違法薬物: なし
   - ギャンブル: なし
   - ユーザー間の交流: **あり**（チャット機能）
5. 「アンケートを保存」
6. レーティングが生成される（通常は「3+」または「全年齢」）

### 7-5. ターゲット層と内容

1. **ターゲット年齢層**: 13歳以上
2. **ストアでの表示設定**: 一般向け

### 7-6. ニュースアプリ

- いいえ

### 7-7. 新型コロナウイルス接触確認アプリ

- いいえ

### 7-8. データセーフティ

1. 「開始する」をクリック
2. データの収集について回答:
   - **位置情報**: 収集しない
   - **個人情報**: 収集しない
   - **財務情報**: 収集しない
   - **メッセージ**: 収集する（チャットメッセージ）
     - 保存期間: 7日間
     - 用途: アプリの機能
     - 共有: 他のユーザーと共有（チャット）
3. 「保存」

### 7-9. 政府機関アプリ

- いいえ

### 7-10. プライバシーポリシー

```
https://koukiniwa.github.io/net-city-beta/privacy.html
```

---

## ステップ8: ストアの設定

### 8-1. メインのストア掲載情報

左メニュー: `ストアでの表示` → `メインのストア掲載情報`

#### アプリ名
```
NET CITY β
```

#### 簡単な説明（80文字以内）
```
みんながつながる仮想の街。リアルタイムチャットで会話を楽しもう！
```

#### 詳しい説明（4000文字以内）
```
NET CITY β - みんながつながる仮想の街

未来的な街の雰囲気の中で、リアルタイムにチャットを楽しめるアプリです。

【主な機能】
• リアルタイムチャット - 送信したメッセージが即座に反映
• シンプルなUI - 誰でも簡単に使える直感的なデザイン
• オンライン人数表示 - 今何人が街にいるか一目でわかる
• 未来的な背景 - サイバーパンク風の街並みが雰囲気を演出
• 自動削除 - メッセージは7日後に自動削除されます

【使い方】
1. 名前を入力して入場
2. メッセージを入力して送信
3. みんなとリアルタイムでチャット！

【こんな人におすすめ】
• 気軽にチャットを楽しみたい人
• 新しい人とつながりたい人
• シンプルなチャットアプリを探している人

登録不要で今すぐ始められます。
みんなで楽しいチャットの時間を過ごしましょう！

【注意事項】
• メッセージは7日間保存され、その後自動削除されます
• 不適切な発言はご遠慮ください
• 個人情報の投稿にはご注意ください
```

### 8-2. アプリアイコン

- サイズ: 512 x 512 px
- 形式: 32-bit PNG（透明背景不可）
- ファイル: `resources/icon.png` をリサイズして使用

### 8-3. フィーチャーグラフィック

- サイズ: 1024 x 500 px
- 形式: JPEG または 24-bit PNG
- 内容: アプリのタイトルと背景画像

**簡単な作り方**:
1. Canvaなどのデザインツールを使用
2. 1024 x 500 pxのキャンバスを作成
3. 「NET CITY β」のテキストと未来的な背景を配置
4. エクスポート

### 8-4. スクリーンショット

**最低要件**: 2枚以上、最大8枚

**電話（必須）**:
- サイズ: 最小320px、最大3840px
- 推奨: 1080 x 1920 px（縦長）

**撮影方法**:
1. Android Studioでエミュレータを起動
2. アプリを実行
3. エミュレータのカメラボタンでスクリーンショット
4. または実機で撮影

**おすすめの画面**:
- 入場画面
- チャット画面（メッセージがある状態）
- オンライン人数が表示されている画面

### 8-5. カテゴリ

- **アプリ**: ソーシャルネットワーキング
- **タグ**: チャット、コミュニケーション

### 8-6. 連絡先の詳細

```
メールアドレス: koukiniwa@example.com
ウェブサイト: https://koukiniwa.github.io/net-city-beta/
電話番号: （任意）
```

---

## ステップ9: リリーストラックとAABのアップロード

### 9-1. 製品版トラックを選択

1. 左メニュー: `リリース` → `製品版`
2. 「新しいリリースを作成」をクリック

### 9-2. AABファイルをアップロード

1. 「アップロード」をクリック
2. `app-release.aab` を選択
3. アップロード完了まで待つ（1〜5分）
4. アップロード完了後、ファイルが表示される

### 9-3. リリース名とリリースノート

**リリース名**:
```
1.0
```

**リリースノート**（日本語）:
```
初回リリース

• リアルタイムチャット機能
• オンライン人数表示
• 未来的なデザイン
• シンプルで使いやすいUI
```

### 9-4. リリースを確認

1. 「保存」をクリック
2. 「リリースを確認」をクリック
3. すべての項目が完了しているか確認
4. 問題がなければ「製品版への公開を開始」をクリック

---

## ステップ10: 審査と公開

### 10-1. 審査期間

- 通常: 数時間〜数日
- 混雑時: 最大1週間

### 10-2. 審査ステータス

Google Play Console の「ダッシュボード」で確認できます:
- **審査中**: Googleが審査中
- **承認済み**: 審査通過
- **却下**: 修正が必要

### 10-3. 公開後

承認されると、Google Play ストアで検索できるようになります:
```
https://play.google.com/store/apps/details?id=com.netcity.app
```

---

## 🎉 おめでとうございます！

アプリが Google Play ストアで公開されました！

### 次のステップ

1. **アプリをテスト**: 実際にダウンロードして動作確認
2. **宣伝**: SNSやウェブサイトでアプリを告知
3. **レビューに返信**: ユーザーからのフィードバックに対応
4. **アップデート**: 定期的に機能追加や改善

---

## 🔄 アプリの更新方法

### バージョンアップ手順

1. **コードを修正**
2. **バージョン番号を更新**:
   - `android/app/build.gradle` を開く
   - `versionCode` を増やす（例: 1 → 2）
   - `versionName` を更新（例: "1.0" → "1.1"）
3. **新しいAABをビルド**:
   - 同じ鍵ストアを使用
   - 手順は初回と同じ
4. **Google Play Console にアップロード**:
   - 新しいリリースを作成
   - AABをアップロード
   - リリースノートを記入
   - 公開

---

## 🐛 トラブルシューティング

### ビルドエラー: Gradle sync failed
```bash
# Android Studio で
File → Invalidate Caches / Restart → Invalidate and Restart
```

### エラー: JAVA_HOME が見つからない
Android Studio に JDK が含まれているので、通常は不要。
エラーが出る場合は Android Studio を再インストール。

### 署名鍵を紛失した
**重要**: 署名鍵がないとアプリを更新できません。
- 新しい鍵で新しいアプリとして公開するしかない
- 必ずバックアップを取る

### アプリがクラッシュする
1. Android Studio の Logcat でエラーを確認
2. Firebase の設定を確認
3. `npm run sync:android` を再実行

---

## 📚 参考リンク

- [Android Studio ダウンロード](https://developer.android.com/studio)
- [Google Play Console](https://play.google.com/console/)
- [Google Play 審査ガイドライン](https://play.google.com/about/developer-content-policy/)
- [Capacitor Android ドキュメント](https://capacitorjs.com/docs/android)

---

**作成者**: koukiniwa
**最終更新**: 2025年10月22日
